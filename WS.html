<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ABCD Encoder/Decoder with CRC - Secure Access</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #1e3a8a, #6b21a8);
      overflow: hidden;
      font-family: 'Arial', sans-serif;
    }
    .content-container {
      text-align: center;
      z-index: 10;
      width: 80%;
      max-width: 600px;
    }
    .title {
      font-size: 2.5rem;
      color: white;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
      animation: pulse 2s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
    }
    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    textarea {
      width: 100%;
      height: 80px;
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-family: monospace;
    }
    button {
      padding: 8px 16px;
      background: #ffffff;
      color: #1e3a8a;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px 0;
    }
    button:hover {
      background: #f0f0f0;
    }
    .output {
      margin-top: 10px;
      padding: 10px;
      border: 1px solid rgba(255, 255, 255, 0.5);
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border-radius: 4px;
      font-family: monospace;
    }
    .hidden {
      display: none;
    }
    input[type="password"] {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
    }
  </style>
</head>
<body>
  <div class="content-container" id="login-container">
    <h1 class="title">Secure Access</h1>
    <p class="text-white text-lg opacity-75">Enter password to access the ABCD Encoder/Decoder</p>
    <input type="password" id="password" placeholder="Password">
    <button onclick="checkPassword()">Submit</button>
  </div>

  <div class="content-container hidden" id="denied-container">
    <h1 class="title">Access Denied</h1>
    <p class="text-white text-lg opacity-75">You do not have permission to view this page.</p>
  </div>

  <div class="content-container hidden" id="encoder-container">
    <h1 class="title">ABCD Encoder/Decoder with CRC</h1>
    
    <h2 class="text-white text-xl mt-4">Encode</h2>
    <textarea id="inputText" placeholder="Enter string with A, B, C, D..."></textarea>
    <button onclick="doEncode()">Encode</button>
    <div id="encoded" class="output"></div>
    
    <h2 class="text-white text-xl mt-4">Decode</h2>
    <textarea id="encodedText" placeholder="Paste encoded string..."></textarea>
    <button onclick="doDecode()">Decode</button>
    <div id="decoded" class="output"></div>

    <button onclick="logout()" class="mt-4">Logout</button>
  </div>

  <canvas id="particles"></canvas>

  <script>
    // Particles animation
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const particles = [];
    const particleCount = 50;

    class Particle {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 3 + 1;
        this.speedX = Math.random() * 2 - 1;
        this.speedY = Math.random() * 2 - 1;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        if (this.size > 0.2) this.size -= 0.05;
        if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
        if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
      }
      draw() {
        ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function initParticles() {
      for (let i = 0; i < particleCount; i++) {
        particles.push(new Particle());
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      particles.forEach((particle, index) => {
        particle.update();
        particle.draw();
        if (particle.size <= 0.2) {
          particles.splice(index, 1);
          particles.push(new Particle());
        }
      });
      requestAnimationFrame(animate);
    }

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    initParticles();
    animate();

    // Authentication
    const PASSWORD = 'password'; // I know it is hardcoded, but this is just a demo.

    function checkAuth() {
      if (localStorage.getItem('auth') === 'admin') {
        showEncoder();
      } else {
        showLogin();
      }
    }

    function checkPassword() {
      const input = document.getElementById('password').value;
      if (input === PASSWORD) {
        localStorage.setItem('auth', 'admin');
        showEncoder();
      } else {
        showDenied();
      }
    }

    function logout() {
      localStorage.removeItem('auth');
      location.reload();
    }

    function showLogin() {
      document.getElementById('login-container').classList.remove('hidden');
      document.getElementById('denied-container').classList.add('hidden');
      document.getElementById('encoder-container').classList.add('hidden');
    }

    function showDenied() {
      document.getElementById('login-container').classList.add('hidden');
      document.getElementById('denied-container').classList.remove('hidden');
      document.getElementById('encoder-container').classList.add('hidden');
    }

    function showEncoder() {
      document.getElementById('login-container').classList.add('hidden');
      document.getElementById('denied-container').classList.add('hidden');
      document.getElementById('encoder-container').classList.remove('hidden');
    }

    // CRC-6 with polynomial x^6 + x + 1 (0x43)
    function crc6(bits) {
      let crc = 0;
      for (let b of bits) {
        let bit = parseInt(b, 2);
        let msb = (crc >> 5) & 1;
        crc = ((crc << 1) & 0x3F) | bit;
        if (msb ^ bit) crc ^= 0x43;
      }
      return crc & 0x3F;
    }

    const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    function toBase62(bits) {
      let out = "";
      for (let i = 0; i < bits.length; i += 6) {
        let chunk = bits.slice(i, i + 6).padEnd(6, "0");
        out += alphabet[parseInt(chunk, 2)];
      }
      return out;
    }

    function fromBase62(str) {
      let bits = "";
      for (let ch of str) {
        let idx = alphabet.indexOf(ch);
        if (idx < 0) throw new Error("Invalid base62 char");
        bits += idx.toString(2).padStart(6, "0");
      }
      return bits;
    }

    // ENCODE
    function encodeABCD(input) {
      let clean = input.toUpperCase().replace(/[^ABCD]/g, "");
      clean = clean.padEnd(25, "A").slice(0, 25); // fixed length 25
      let bits = clean
        .replace(/A/g, "00")
        .replace(/B/g, "01")
        .replace(/C/g, "10")
        .replace(/D/g, "11");

      let crc = crc6(bits).toString(2).padStart(6, "0");
      let fullBits = bits + crc; // 50 + 6 = 56 bits
      return toBase62(fullBits);
    }

    // DECODE
    function decodeABCD(encoded) {
      let bits = fromBase62(encoded);
      let useful = bits.slice(0, 50);   // only original data
      let checkCrcBits = bits.slice(50, 56);
      let actualCrc = crc6(useful).toString(2).padStart(6, "0");

      if (actualCrc !== checkCrcBits) throw new Error("CRC mismatch");

      let output = "";
      for (let i = 0; i < 50; i += 2) {
        let pair = useful.slice(i, i + 2);
        if (pair === "00") output += "A";
        else if (pair === "01") output += "B";
        else if (pair === "10") output += "C";
        else if (pair === "11") output += "D";
      }
      return output;
    }

    // UI functions
    function doEncode() {
      let input = document.getElementById("inputText").value;
      try {
        let encoded = encodeABCD(input);
        document.getElementById("encoded").textContent = encoded;
        document.getElementById("encodedText").value = encoded;
      } catch (e) {
        document.getElementById("encoded").textContent = "Error: " + e.message;
      }
    }

    function doDecode() {
      let input = document.getElementById("encodedText").value.trim();
      try {
        let decoded = decodeABCD(input);
        document.getElementById("decoded").textContent = decoded;
      } catch (e) {
        document.getElementById("decoded").textContent = "Error: " + e.message;
      }
    }

    // Initialize
    checkAuth();
  </script>
</body>
</html>